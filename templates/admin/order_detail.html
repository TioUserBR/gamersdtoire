{% extends 'admin/base_admin.html' %}

{% block content %}
<h2 class="mb-4"><i class="fas fa-receipt"></i> Pedido #{{ order.id }}</h2>

<div class="row g-4">
    <div class="col-md-8">
        <div class="card shadow-sm">
            <div class="card-header">
                <h5 class="mb-0">Itens do Pedido</h5>
            </div>
            <div class="card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Produto</th>
                            <th>Preço</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in order.items %}
                        <tr>
                            <td>{{ item.product_name }}</td>
                            <td class="text-success">R$ {{ "%.2f"|format(item.price) }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr>
                            <th>Total</th>
                            <th class="text-success fs-5">R$ {{ "%.2f"|format(order.total) }}</th>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card shadow-sm mb-3">
            <div class="card-header">
                <h5 class="mb-0">Cliente</h5>
            </div>
            <div class="card-body">
                <p><strong>Nome:</strong> {{ order.customer_name or 'N/A' }}</p>
                <p><strong>Email:</strong> {{ order.customer_email or 'N/A' }}</p>
                <p><strong>Telefone:</strong> {{ order.customer_phone or 'N/A' }}</p>
                {% if order.notes %}
                <p><strong>Observações:</strong> {{ order.notes }}</p>
                {% endif %}
            </div>
        </div>

        <div class="card shadow-sm">
            <div class="card-header">
                <h5 class="mb-0">Atualizar Status</h5>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('admin_update_order_status', id=order.id) }}">
                    <select name="status" class="form-select mb-3">
                        <option value="pendente" {% if order.status == 'pendente' %}selected{% endif %}>Pendente</option>
                        <option value="pago" {% if order.status == 'pago' %}selected{% endif %}>Pago</option>
                        <option value="entregue" {% if order.status == 'entregue' %}selected{% endif %}>Entregue</option>
                        <option value="cancelado" {% if order.status == 'cancelado' %}selected{% endif %}>Cancelado</option>
                    </select>
                    <button type="submit" class="btn btn-warning w-100">
                        <i class="fas fa-save"></i> Atualizar
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}